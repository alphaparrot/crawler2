#!/bin/bash
# run-script generated by Most Sun Apr 15 20:47:19 2018
EXP=MOST    # Name your experiment here
rm -f plasim_restart
rm -f Abort_Message
YEAR=0
YEARS=10
while [ $YEAR -lt $YEARS ]
do
   YEAR=`expr $YEAR + 1`
   DATANAME=`printf '%s.%03d' $EXP $YEAR`         
   SNAPNAME=`printf '%s_SNAP.%03d' $EXP $YEAR`
   DIAGNAME=`printf '%s_DIAG.%03d' $EXP $YEAR`
   RESTNAME=`printf '%s_REST.%03d' $EXP $YEAR`
   SNOWNAME=`printf '%s_SNOW.%03d' $EXP $YEAR`
   mpiexec -np $1 most_plasim_t21_l${2}_p${1}..x
   [ -e Abort_Message ] && exit 1
   [ -e plasim_output ] && mv plasim_output $DATANAME
   [ -e plasim_snapshot ] && mv plasim_snapshot $SNAPNAME
   [ -e $DATANAME ] && ./burn7.x -n <example.nl>burnout $DATANAME $DATANAME.nc
   [ -e $SNAPNAME ] && ./burn7.x -n <snapshot.nl>snapout $SNAPNAME $SNAPNAME.nc
   [ -e plasim_diag ] && mv plasim_diag $DIAGNAME
   [ -e plasim_status ] && cp plasim_status plasim_restart
   [ -e plasim_status ] && mv plasim_status $RESTNAME
   [ -e restart_snow ] && mv restart_snow $SNOWNAME
done
